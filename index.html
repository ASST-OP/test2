<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>繰り返される文字列の一覧</title>
    <style>
        .substring {
            display: inline-block;
            margin: 5px;
            padding: 5px;
            border: 1px solid #ccc;
            cursor: pointer;
        }
        .substring:hover {
            background-color: #f0f0f0;
        }
    </style>
</head>
<body>
    <h1>繰り返される文字列の一覧を表示</h1>
    <input type="text" id="inputString" placeholder="文字列を入力してください">
    <button onclick="displayRepeatingSubstrings()">表示</button>
    <div id="result"></div>

    <script>
        function displayRepeatingSubstrings() {
            let inputString = document.getElementById('inputString').value;
            let substrings = findRepeatingSubstrings(inputString);
            
            let resultDiv = document.getElementById('result');
            resultDiv.innerHTML = ''; // 結果をクリア

            if (substrings.length > 0) {
                substrings.forEach(substring => {
                    let substringElement = document.createElement('span');
                    substringElement.className = 'substring';
                    substringElement.textContent = substring;
                    substringElement.onclick = () => copyToClipboard(substring);
                    resultDiv.appendChild(substringElement);
                });
            } else {
                resultDiv.innerHTML = '<p>繰り返される文字列はありません。</p>';
            }
        }

        function findRepeatingSubstrings(str) {
            let substrings = {};
            let length = str.length;

            // すべてのサブストリングを調べる
            for (let i = 0; i < length; i++) {
                for (let j = i + 1; j <= length; j++) {
                    let substring = str.substring(i, j);
                    if (substring.length > 1) { // 1文字以上のサブストリング
                        if (substrings[substring]) {
                            substrings[substring]++;
                        } else {
                            substrings[substring] = 1;
                        }
                    }
                }
            }

            // 繰り返されるサブストリングのみ抽出
            return Object.keys(substrings).filter(key => substrings[key] > 1);
        }

        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                alert(`'${text}' をクリップボードにコピーしました`);
            }).catch(err => {
                console.error('クリップボードへのコピーに失敗しました:', err);
            });
        }
    </script>
</body>
</html>
